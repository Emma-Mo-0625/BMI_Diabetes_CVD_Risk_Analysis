 
 1          OPTIONS NONOTES NOSTIMER NOSOURCE NOSYNTAXCHECK;
 68         
 69         ***********************************************************
 70         *  Study:             Impact of BMI on Diabetes and Cardiovascular Disease Risk
 71         *  Program:           group7 midterm.sas
 72         *  Created by:        Rongrong Mo(Emma), Yiling Chiang(Emily)
 73         *  Date Created:      01NOV2024
 74         *  Description:       Create Table 1 and 2
 75         *
 76         *
 77         *  Input files:       file_name
 78         *  Output files:      tfl.table_2, table_1.rtf
 79         *
 80         *  Other Comments:    None
 81         *
 82         *
 83         ***********************************************************
 84         *  Modification History: None
 85         *
 86         *  Modification Number:  1
 87         *  Modified by:          Shengge Cheng
 88         *  Date Modified:        01NOV2024
 89         *  Reason Modified:      describe changes made
 90         *
 91         **********************************************************
 92         * Copyright  .
 93         * All rights reserved.
 94         **********************************************************;
 95         
 96         
 97         *******************************************************;
 98         ** APPLY CENTRAL CONFIGURATIONS                      **;
 99         *******************************************************;
 100        
 101        proc import datafile="/home/u64041730/biostat203a/midterm/diabetes_binary_5050split_health_indicators_BRFSS2015.csv"
 102            out=diabetes
 103            dbms=csv
 104            replace;
 105            getnames=yes;
 106        run;
 
 NOTE: Unable to open parameter catalog: SASUSER.PARMS.PARMS.SLIST in update mode. Temporary parameter values will be saved to 
 WORK.PARMS.PARMS.SLIST.
 107         /**********************************************************************
 108         *   PRODUCT:   SAS
 109         *   VERSION:   9.4
 110         *   CREATOR:   External File Interface
 111         *   DATE:      01NOV24
 112         *   DESC:      Generated SAS Datastep Code
 113         *   TEMPLATE SOURCE:  (None Specified.)
 114         ***********************************************************************/
 115            data WORK.DIABETES    ;
 116            %let _EFIERR_ = 0; /* set the ERROR detection macro variable */
 117            infile '/home/u64041730/biostat203a/midterm/diabetes_binary_5050split_health_indicators_BRFSS2015.csv' delimiter =
 117      ! ',' MISSOVER DSD lrecl=32767 firstobs=2 ;
 118               informat Diabetes_binary best32. ;
 119               informat HighBP best32. ;
 120               informat HighChol best32. ;
 121               informat CholCheck best32. ;
 122               informat BMI best32. ;
 123               informat Smoker best32. ;
 124               informat Stroke best32. ;
 125               informat HeartDiseaseorAttack best32. ;
 126               informat PhysActivity best32. ;
 127               informat Fruits best32. ;
 128               informat Veggies best32. ;
 129               informat HvyAlcoholConsump best32. ;
 130               informat AnyHealthcare best32. ;
 131               informat NoDocbcCost best32. ;
 132               informat GenHlth best32. ;
 133               informat MentHlth best32. ;
 134               informat PhysHlth best32. ;
 135               informat DiffWalk best32. ;
 136               informat Sex best32. ;
 137               informat Age best32. ;
 138               informat Education best32. ;
 139               informat Income best32. ;
 140               format Diabetes_binary best12. ;
 141               format HighBP best12. ;
 142               format HighChol best12. ;
 143               format CholCheck best12. ;
 144               format BMI best12. ;
 145               format Smoker best12. ;
 146               format Stroke best12. ;
 147               format HeartDiseaseorAttack best12. ;
 148               format PhysActivity best12. ;
 149               format Fruits best12. ;
 150               format Veggies best12. ;
 151               format HvyAlcoholConsump best12. ;
 152               format AnyHealthcare best12. ;
 153               format NoDocbcCost best12. ;
 154               format GenHlth best12. ;
 155               format MentHlth best12. ;
 156               format PhysHlth best12. ;
 157               format DiffWalk best12. ;
 158               format Sex best12. ;
 159               format Age best12. ;
 160               format Education best12. ;
 161               format Income best12. ;
 162            input
 163                        Diabetes_binary
 164                        HighBP
 165                        HighChol
 166                        CholCheck
 167                        BMI
 168                        Smoker
 169                        Stroke
 170                        HeartDiseaseorAttack
 171                        PhysActivity
 172                        Fruits
 173                        Veggies
 174                        HvyAlcoholConsump
 175                        AnyHealthcare
 176                        NoDocbcCost
 177                        GenHlth
 178                        MentHlth
 179                        PhysHlth
 180                        DiffWalk
 181                        Sex
 182                        Age
 183                        Education
 184                        Income
 185            ;
 186            if _ERROR_ then call symputx('_EFIERR_',1);  /* set ERROR detection macro variable */
 187            run;
 
 NOTE: The infile '/home/u64041730/biostat203a/midterm/diabetes_binary_5050split_health_indicators_BRFSS2015.csv' is:
       Filename=/home/u64041730/biostat203a/midterm/diabetes_binary_5050split_health_indicators_BRFSS2015.csv,
       Owner Name=u64041730,Group Name=oda,
       Access Permission=-rw-r--r--,
       Last Modified=01Nov2024:11:13:53,
       File Size (bytes)=6347570
 
 NOTE: 70692 records were read from the infile 
       '/home/u64041730/biostat203a/midterm/diabetes_binary_5050split_health_indicators_BRFSS2015.csv'.
       The minimum record length was 88.
       The maximum record length was 91.
 NOTE: The data set WORK.DIABETES has 70692 observations and 22 variables.
 NOTE: DATA statement used (Total process time):
       real time           0.09 seconds
       user cpu time       0.09 seconds
       system cpu time     0.00 seconds
       memory              10595.50k
       OS Memory           35872.00k
       Timestamp           11/01/2024 09:24:17 PM
       Step Count                        43  Switch Count  2
       Page Faults                       0
       Page Reclaims                     328
       Page Swaps                        0
       Voluntary Context Switches        15
       Involuntary Context Switches      2
       Block Input Operations            0
       Block Output Operations           24600
       
 
 70692 rows created in WORK.DIABETES from 
 /home/u64041730/biostat203a/midterm/diabetes_binary_5050split_health_indicators_BRFSS2015.csv.
   
   
   
 NOTE: WORK.DIABETES data set was successfully created.
 NOTE: The data set WORK.DIABETES has 70692 observations and 22 variables.
 NOTE: PROCEDURE IMPORT used (Total process time):
       real time           0.14 seconds
       user cpu time       0.12 seconds
       system cpu time     0.02 seconds
       memory              10595.50k
       OS Memory           36388.00k
       Timestamp           11/01/2024 09:24:17 PM
       Step Count                        43  Switch Count  10
       Page Faults                       0
       Page Reclaims                     1835
       Page Swaps                        0
       Voluntary Context Switches        91
       Involuntary Context Switches      4
       Block Input Operations            0
       Block Output Operations           24656
       
 
 188        
 189        proc import datafile="/home/u64041730/biostat203a/midterm/heart_disease_health_indicators_BRFSS2015.csv"
 190            out=heartdisease
 191            dbms=csv
 192            replace;
 193            getnames=yes;
 194        run;
 
 NOTE: Unable to open parameter catalog: SASUSER.PARMS.PARMS.SLIST in update mode. Temporary parameter values will be saved to 
 WORK.PARMS.PARMS.SLIST.
 195         /**********************************************************************
 196         *   PRODUCT:   SAS
 197         *   VERSION:   9.4
 198         *   CREATOR:   External File Interface
 199         *   DATE:      01NOV24
 200         *   DESC:      Generated SAS Datastep Code
 201         *   TEMPLATE SOURCE:  (None Specified.)
 202         ***********************************************************************/
 203            data WORK.HEARTDISEASE    ;
 204            %let _EFIERR_ = 0; /* set the ERROR detection macro variable */
 205            infile '/home/u64041730/biostat203a/midterm/heart_disease_health_indicators_BRFSS2015.csv' delimiter = ',' MISSOVER
 205      ! DSD lrecl=32767 firstobs=2 ;
 206               informat HeartDiseaseorAttack best32. ;
 207               informat HighBP best32. ;
 208               informat HighChol best32. ;
 209               informat CholCheck best32. ;
 210               informat BMI best32. ;
 211               informat Smoker best32. ;
 212               informat Stroke best32. ;
 213               informat Diabetes best32. ;
 214               informat PhysActivity best32. ;
 215               informat Fruits best32. ;
 216               informat Veggies best32. ;
 217               informat HvyAlcoholConsump best32. ;
 218               informat AnyHealthcare best32. ;
 219               informat NoDocbcCost best32. ;
 220               informat GenHlth best32. ;
 221               informat MentHlth best32. ;
 222               informat PhysHlth best32. ;
 223               informat DiffWalk best32. ;
 224               informat Sex best32. ;
 225               informat Age best32. ;
 226               informat Education best32. ;
 227               informat Income best32. ;
 228               format HeartDiseaseorAttack best12. ;
 229               format HighBP best12. ;
 230               format HighChol best12. ;
 231               format CholCheck best12. ;
 232               format BMI best12. ;
 233               format Smoker best12. ;
 234               format Stroke best12. ;
 235               format Diabetes best12. ;
 236               format PhysActivity best12. ;
 237               format Fruits best12. ;
 238               format Veggies best12. ;
 239               format HvyAlcoholConsump best12. ;
 240               format AnyHealthcare best12. ;
 241               format NoDocbcCost best12. ;
 242               format GenHlth best12. ;
 243               format MentHlth best12. ;
 244               format PhysHlth best12. ;
 245               format DiffWalk best12. ;
 246               format Sex best12. ;
 247               format Age best12. ;
 248               format Education best12. ;
 249               format Income best12. ;
 250            input
 251                        HeartDiseaseorAttack
 252                        HighBP
 253                        HighChol
 254                        CholCheck
 255                        BMI
 256                        Smoker
 257                        Stroke
 258                        Diabetes
 259                        PhysActivity
 260                        Fruits
 261                        Veggies
 262                        HvyAlcoholConsump
 263                        AnyHealthcare
 264                        NoDocbcCost
 265                        GenHlth
 266                        MentHlth
 267                        PhysHlth
 268                        DiffWalk
 269                        Sex
 270                        Age
 271                        Education
 272                        Income
 273            ;
 274            if _ERROR_ then call symputx('_EFIERR_',1);  /* set ERROR detection macro variable */
 275            run;
 
 NOTE: The infile '/home/u64041730/biostat203a/midterm/heart_disease_health_indicators_BRFSS2015.csv' is:
       Filename=/home/u64041730/biostat203a/midterm/heart_disease_health_indicators_BRFSS2015.csv,
       Owner Name=u64041730,Group Name=oda,
       Access Permission=-rw-r--r--,
       Last Modified=01Nov2024:11:13:52,
       File Size (bytes)=22738147
 
 NOTE: 253680 records were read from the infile '/home/u64041730/biostat203a/midterm/heart_disease_health_indicators_BRFSS2015.csv'.
       The minimum record length was 88.
       The maximum record length was 91.
 NOTE: The data set WORK.HEARTDISEASE has 253680 observations and 22 variables.
 NOTE: DATA statement used (Total process time):
       real time           0.32 seconds
       user cpu time       0.30 seconds
       system cpu time     0.02 seconds
       memory              10595.12k
       OS Memory           35872.00k
       Timestamp           11/01/2024 09:24:18 PM
       Step Count                        44  Switch Count  2
       Page Faults                       0
       Page Reclaims                     277
       Page Swaps                        0
       Voluntary Context Switches        17
       Involuntary Context Switches      2
       Block Input Operations            0
       Block Output Operations           87568
       
 
 253680 rows created in WORK.HEARTDISEASE from /home/u64041730/biostat203a/midterm/heart_disease_health_indicators_BRFSS2015.csv.
   
   
   
 NOTE: WORK.HEARTDISEASE data set was successfully created.
 NOTE: The data set WORK.HEARTDISEASE has 253680 observations and 22 variables.
 NOTE: PROCEDURE IMPORT used (Total process time):
       real time           0.37 seconds
       user cpu time       0.34 seconds
       system cpu time     0.03 seconds
       memory              10595.12k
       OS Memory           36388.00k
       Timestamp           11/01/2024 09:24:18 PM
       Step Count                        44  Switch Count  9
       Page Faults                       0
       Page Reclaims                     1665
       Page Swaps                        0
       Voluntary Context Switches        90
       Involuntary Context Switches      4
       Block Input Operations            0
       Block Output Operations           87584
       
 
 276        
 277        /* Sort the diabetes dataset by Age */
 278        proc sort data=diabetes;
 279            by age;
 280        run;
 
 NOTE: There were 70692 observations read from the data set WORK.DIABETES.
 NOTE: The data set WORK.DIABETES has 70692 observations and 22 variables.
 NOTE: PROCEDURE SORT used (Total process time):
       real time           0.03 seconds
       user cpu time       0.02 seconds
       system cpu time     0.02 seconds
       memory              17424.34k
       OS Memory           45220.00k
       Timestamp           11/01/2024 09:24:18 PM
       Step Count                        45  Switch Count  3
       Page Faults                       0
       Page Reclaims                     3751
       Page Swaps                        0
       Voluntary Context Switches        19
       Involuntary Context Switches      0
       Block Input Operations            0
       Block Output Operations           24584
       
 
 281        
 282        /* Sort the heartdisease dataset by Age */
 283        proc sort data=heartdisease;
 284            by age;
 285        run;
 
 NOTE: There were 253680 observations read from the data set WORK.HEARTDISEASE.
 NOTE: The data set WORK.HEARTDISEASE has 253680 observations and 22 variables.
 NOTE: PROCEDURE SORT used (Total process time):
       real time           0.13 seconds
       user cpu time       0.07 seconds
       system cpu time     0.07 seconds
       memory              53982.25k
       OS Memory           81740.00k
       Timestamp           11/01/2024 09:24:18 PM
       Step Count                        46  Switch Count  5
       Page Faults                       0
       Page Reclaims                     12724
       Page Swaps                        0
       Voluntary Context Switches        20
       Involuntary Context Switches      2
       Block Input Operations            0
       Block Output Operations           87560
       
 
 286        
 287        /* Now merge the two datasets */
 288        data merged_data;
 289            merge diabetes heartdisease;
 290            by age;
 291        run;
 
 NOTE: MERGE statement has more than one data set with repeats of BY values.
 NOTE: There were 70692 observations read from the data set WORK.DIABETES.
 NOTE: There were 253680 observations read from the data set WORK.HEARTDISEASE.
 NOTE: The data set WORK.MERGED_DATA has 253680 observations and 23 variables.
 NOTE: DATA statement used (Total process time):
       real time           0.07 seconds
       user cpu time       0.05 seconds
       system cpu time     0.04 seconds
       memory              5385.50k
       OS Memory           34228.00k
       Timestamp           11/01/2024 09:24:18 PM
       Step Count                        47  Switch Count  5
       Page Faults                       0
       Page Reclaims                     892
       Page Swaps                        0
       Voluntary Context Switches        20
       Involuntary Context Switches      1
       Block Input Operations            0
       Block Output Operations           91400
       
 
 292        
 293        
 294        proc contents data = diabetes;
 295        run;
 
 NOTE: PROCEDURE CONTENTS used (Total process time):
       real time           0.04 seconds
       user cpu time       0.04 seconds
       system cpu time     0.00 seconds
       memory              3185.56k
       OS Memory           30384.00k
       Timestamp           11/01/2024 09:24:18 PM
       Step Count                        48  Switch Count  0
       Page Faults                       0
       Page Reclaims                     287
       Page Swaps                        0
       Voluntary Context Switches        3
       Involuntary Context Switches      2
       Block Input Operations            0
       Block Output Operations           32
       
 
 296        
 297        proc contents data = heartdisease;
 298        run;
 
 NOTE: PROCEDURE CONTENTS used (Total process time):
       real time           0.03 seconds
       user cpu time       0.03 seconds
       system cpu time     0.00 seconds
       memory              2341.56k
       OS Memory           30128.00k
       Timestamp           11/01/2024 09:24:18 PM
       Step Count                        49  Switch Count  0
       Page Faults                       0
       Page Reclaims                     283
       Page Swaps                        0
       Voluntary Context Switches        3
       Involuntary Context Switches      2
       Block Input Operations            0
       Block Output Operations           24
       
 
 299        
 300        
 301        /* Step 1: Assign descriptive labels to each age group */
 302        
 303        data categorized_data;
 304            set merged_data;
 305        
 306            /* Categorize BMI */
 307            if bmi < 18.5 then nbmi = 'Underweight';
 308            else if bmi <= 24.9 and bmi >= 18.5 then nbmi = 'Healthy';
 309            else if bmi <= 29.9 and bmi >= 25 then nbmi = 'Overweight';
 310            else if bmi <= 39.9 and bmi >= 30 then nbmi = 'Obese';
 311            else if bmi >= 40 then nbmi = 'Severely obese';
 312        
 313        run;
 
 NOTE: There were 253680 observations read from the data set WORK.MERGED_DATA.
 NOTE: The data set WORK.CATEGORIZED_DATA has 253680 observations and 24 variables.
 NOTE: DATA statement used (Total process time):
       real time           0.06 seconds
       user cpu time       0.04 seconds
       system cpu time     0.03 seconds
       memory              3608.87k
       OS Memory           32176.00k
       Timestamp           11/01/2024 09:24:18 PM
       Step Count                        50  Switch Count  9
       Page Faults                       0
       Page Reclaims                     561
       Page Swaps                        0
       Voluntary Context Switches        37
       Involuntary Context Switches      0
       Block Input Operations            0
       Block Output Operations           99336
       
 
 314        
 315        /* Step 2: Calculate the percentage of Diabetes and Heart Disease for each BMI category */
 316        
 317        proc freq data=categorized_data;
 318            tables nbmi*Diabetes_binary / nocol nopercent norow;
 319            tables nbmi*HeartDiseaseorAttack / nocol nopercent norow;
 320        run;
 
 NOTE: There were 253680 observations read from the data set WORK.CATEGORIZED_DATA.
 NOTE: PROCEDURE FREQ used (Total process time):
       real time           0.07 seconds
       user cpu time       0.07 seconds
       system cpu time     0.01 seconds
       memory              2786.34k
       OS Memory           30644.00k
       Timestamp           11/01/2024 09:24:18 PM
       Step Count                        51  Switch Count  11
       Page Faults                       0
       Page Reclaims                     376
       Page Swaps                        0
       Voluntary Context Switches        49
       Involuntary Context Switches      2
       Block Input Operations            0
       Block Output Operations           544
       
 
 321        
 322        /* Step 3: Use PROC TABULATE to generate a summary table with age ranges */
 323        
 324        proc tabulate data=categorized_data;
 325            class nbmi;
 326            var Diabetes_binary HeartDiseaseorAttack;
 327            table nbmi, (Diabetes_binary HeartDiseaseorAttack)*(mean='Percentage') / misstext='0.0%';
 328        run;
 
 NOTE: There were 253680 observations read from the data set WORK.CATEGORIZED_DATA.
 NOTE: PROCEDURE TABULATE used (Total process time):
       real time           0.03 seconds
       user cpu time       0.04 seconds
       system cpu time     0.03 seconds
       memory              9580.34k
       OS Memory           36296.00k
       Timestamp           11/01/2024 09:24:18 PM
       Step Count                        52  Switch Count  12
       Page Faults                       0
       Page Reclaims                     1862
       Page Swaps                        0
       Voluntary Context Switches        137
       Involuntary Context Switches      1
       Block Input Operations            0
       Block Output Operations           544
       
 
 329        
 330        /* Pie Chart for Diabetes */
 331        proc gchart data=categorized_data;
 332            where Diabetes_binary = 1; /* Select individuals with diabetes */
 333            pie nbmi / coutline=black
 334                       percent=inside
 335                       noheading
 336                       value=arrow;
 337            title "Percentage of Individuals with Diabetes by BMI Category";
 338        run;
 
 339        quit;
 
 NOTE: There were 218334 observations read from the data set WORK.CATEGORIZED_DATA.
       WHERE Diabetes_binary=1;
 NOTE: PROCEDURE GCHART used (Total process time):
       real time           0.24 seconds
       user cpu time       0.21 seconds
       system cpu time     0.03 seconds
       memory              18231.43k
       OS Memory           46512.00k
       Timestamp           11/01/2024 09:24:19 PM
       Step Count                        53  Switch Count  36
       Page Faults                       0
       Page Reclaims                     4378
       Page Swaps                        0
       Voluntary Context Switches        103
       Involuntary Context Switches      23
       Block Input Operations            0
       Block Output Operations           5208
       
 
 340        
 341        
 342        
 343        /* Pie Chart for Heart Disease */
 344        proc gchart data=categorized_data;
 345            where HeartDiseaseorAttack = 1; /* Select individuals with heart disease */
 346            pie nbmi / coutline=black
 347                       percent=inside
 348                       noheading
 349                       value=arrow;
 350            title "Percentage of Individuals with Heart Disease by BMI Category";
 351        run;
 
 352        quit;
 
 NOTE: There were 23893 observations read from the data set WORK.CATEGORIZED_DATA.
       WHERE HeartDiseaseorAttack=1;
 NOTE: PROCEDURE GCHART used (Total process time):
       real time           0.16 seconds
       user cpu time       0.15 seconds
       system cpu time     0.01 seconds
       memory              7542.59k
       OS Memory           35104.00k
       Timestamp           11/01/2024 09:24:19 PM
       Step Count                        54  Switch Count  5
       Page Faults                       0
       Page Reclaims                     1243
       Page Swaps                        0
       Voluntary Context Switches        23
       Involuntary Context Switches      4
       Block Input Operations            0
       Block Output Operations           792
       
 
 353        
 354        /* Reshape data for plotting */
 355        data plot_data;
 356            set categorized_data;
 357            Category = "Diabetes";
 358            Count = Diabetes_binary;
 359            output;
 360        
 361            Category = "Heart Disease";
 362            Count = HeartDiseaseorAttack;
 363            output;
 364        
 365            keep nbmi Category Count;
 366        run;
 
 NOTE: There were 253680 observations read from the data set WORK.CATEGORIZED_DATA.
 NOTE: The data set WORK.PLOT_DATA has 507360 observations and 3 variables.
 NOTE: DATA statement used (Total process time):
       real time           0.05 seconds
       user cpu time       0.03 seconds
       system cpu time     0.02 seconds
       memory              3613.46k
       OS Memory           33712.00k
       Timestamp           11/01/2024 09:24:19 PM
       Step Count                        55  Switch Count  7
       Page Faults                       0
       Page Reclaims                     527
       Page Swaps                        0
       Voluntary Context Switches        27
       Involuntary Context Switches      1
       Block Input Operations            0
       Block Output Operations           32008
       
 
 367        
 368        /* Stacked Bar Chart */
 369        proc sgplot data=plot_data;
 370            vbar Category / response=Count group=nbmi groupdisplay=stack datalabel;
 371            keylegend / title="BMI Category";
 372            xaxis label="Condition";
 373            yaxis label="Count";
 374            title "Stacked Bar Chart of Diabetes and Heart Disease by BMI Category";
 375        run;
 
 NOTE: PROCEDURE SGPLOT used (Total process time):
       real time           0.25 seconds
       user cpu time       0.12 seconds
       system cpu time     0.01 seconds
       memory              9576.87k
       OS Memory           36148.00k
       Timestamp           11/01/2024 09:24:19 PM
       Step Count                        56  Switch Count  5
       Page Faults                       0
       Page Reclaims                     1675
       Page Swaps                        0
       Voluntary Context Switches        226
       Involuntary Context Switches      4
       Block Input Operations            0
       Block Output Operations           624
       
 NOTE: There were 507360 observations read from the data set WORK.PLOT_DATA.
 
 376        
 377        OPTIONS NONOTES NOSTIMER NOSOURCE NOSYNTAXCHECK;
 387        